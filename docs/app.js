"use strict";(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)})([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)},function(module,exports,__webpack_require__){var modules=["ngRoute","pageHighway","pageD3Almanac"];__webpack_require__(2);__webpack_require__(3);__webpack_require__(4);__webpack_require__(5);angular.module("sandbox",modules).config(["$locationProvider","$routeProvider",function($locationProvider,$routeProvider){$locationProvider.html5Mode(false);$routeProvider.when("/",{templateUrl:"pages/home.html",controllerAs:"$ctrl",controller:function controller(){angular.element("[ng-view]").attr("ng-view","pageHome")}}).otherwise({redirectTo:"/"})}]).directive("toggleUl",function(){return{restrict:"A",link:function link(scope,element,attrs){element.on("click",function(){element.toggleClass("expand")}).on("keypress",function(e){if(e.key==="Enter"||e.key===" "){e.preventDefault();element.toggleClass("expand")}})}}})},function(module,exports){angular.module("pageHighway",["ngRoute"])},function(module,exports){angular.module("pageHighway").config(["$locationProvider","$routeProvider",function($locationProvider,$routeProvider){$routeProvider.when("/d3/highway/",{templateUrl:"pages/d3/highway/highway.html",controllerAs:"$ctrl",controller:"ctrlHighway"})}]).controller("ctrlHighway",["$scope",function($scope){var _this=this;angular.element("[ng-view]").attr("ng-view","pageHighway");this.sim=null;this.svg=angular.element("svg");this.d3=d3.select("svg");this.cars=[];this.clearSim=function(){if(_this.sim&&_this.sim.stop)_this.sim.stop();_this.sim=d3.forceSimulation().stop().alphaMin(0.01);_this.sim.alphaDecay(0).velocityDecay(0)};$scope.btnPause="Resume";this.buildSim=function(){var forces=[];forces.push(carCollision(CAR));for(var i=0,f=forces.length;i<f;i++){_this.sim.force(i,forces.pop())}_this.sim.on("tick",function(){_this.d3.selectAll("g.roadway").selectAll("text").text(function(d){return d.carsPassed});_this.nodes.selectAll("rect").attr("x",function(d){if(d.x<0-CAR.w){d.x=2000+CAR.w;d.movingTo=Math.floor(Math.random()*roadways[d.roadway].lanes.length);d.lane=d.movingTo;roadways[d.roadway].carsPassed++;d.y=roadways[d.roadway].lanes[d.lane];d.vx=d.cruiseControl}if(d.x>2000+CAR.w&&d.vx>0){d.vx=d.cruiseControl;d.x=2000+CAR.w}return d.x-CAR.w/2}).attr("y",function(d){if(d.occupiedLanes.indexOf(d.movingTo)!==-1)d.movingTo=d.lane;if(Math.abs(roadways[d.roadway].lanes[d.movingTo]-d.y)<=roadways[d.roadway].laneWidth/30){d.lane=d.movingTo;d.vy=0}else{d.vy=Math.sign(roadways[d.roadway].lanes[d.movingTo]-d.y)*roadways[d.roadway].laneWidth/30}return d.y-CAR.h/2})})};$scope.toggleSim=function(){if($scope.btnPause==="Pause")_this.pauseSim();else _this.resumeSim()};this.pauseSim=function(){_this.d3.selectAll("g.roadway").classed("animated",false);_this.sim.stop();$scope.btnPause="Resume"};this.resumeSim=function(){_this.d3.selectAll("g.roadway").classed("animated",true);_this.sim.restart();$scope.btnPause="Pause"};function changeLanes(){this.movingTo=this.lane===roadways[this.roadway].lanes.length-1?this.lane-1:this.lane+1}this.addCar=function(i,car){if(typeof i!=="number")return;if(i<0||i>=roadways.length)return;if(!roadways[i])return;if(typeof car.lane==="number"&&car.lane>=0&&car.lane<roadways[i].lanes.length){if(!car.y){car.y=roadways[i].lanes[car.lane]}if(typeof car.movingTo==="undefined")car.movingTo=car.lane}if(!car.id){car.id="car"+_this.cars.length}car.x=car.x||2000+CAR.w;car.separation=car.separation||CAR.w/10;car.roadway=i;car.vy=0;car.changeLanes=changeLanes.bind(car);_this.cars.push(car);_this.sim.nodes(_this.cars);var cars=_this.d3.selectAll("g.car").data(_this.sim.nodes()).enter().append("g").classed("car",true);cars.append("rect").attr("width",CAR.w).attr("height",CAR.h);_this.nodes=_this.d3.selectAll("g.car")};var CAR={w:90,h:40};var roadways=[{carsPassed:0,laneWidth:70,numLanes:3,lanes:[]},{carsPassed:0,laneWidth:70,numLanes:3,lanes:[]},{carsPassed:0,laneWidth:70,numLanes:3,lanes:[]}];this.roadways=roadways;roadways.forEach(function(roadway,i){roadway.y=2000/(roadways.length+1)*(i+1);roadway.i=i});roadways.forEach(function(roadway,j){for(var i=0;i<roadway.numLanes;i++){roadway.lanes.push(i*roadway.laneWidth+2000/(roadways.length+1)*(j+1)-roadway.numLanes*roadway.laneWidth/2+roadway.laneWidth/2)}});var d3roadways=this.d3.selectAll("g.roadway").data(roadways);d3roadways=d3roadways.enter().append("g").classed("roadway",true).merge(d3roadways);d3roadways.append("rect").attr("x",0).attr("width",2000).attr("height",function(d){return d.numLanes*d.laneWidth}).attr("y",function(d){return d.y-d.numLanes*d.laneWidth/2});d3roadways.append("text").attr("x",20).attr("y",function(d){return d.y-d.numLanes*d.laneWidth/2-10});roadways.forEach(function(roadway,i){var ry=2000/(roadways.length+1)*(i+1);for(var _i=1;_i<roadway.numLanes;_i++){var line=_this.d3.selectAll("g.roadway").append("line");var y=_i*roadway.laneWidth+ry-roadway.numLanes*roadway.laneWidth/2;line.attr("x1",2000);line.attr("x2",0);line.attr("y1",y);line.attr("y2",y)}});this.clearSim();this.buildSim();this.addCar(0,{id:"center",x:2000/2,lane:1,cruiseControl:0});this.addCar(1,{id:"center",x:2000/2,lane:0,cruiseControl:0});this.addCar(2,{id:"center",x:2000/2,lane:0,cruiseControl:0});this.addCar(2,{id:"center2",x:2000/2,lane:2,cruiseControl:0});roadways.forEach(function(roadway,i){_this.addCar(i,{lane:1,x:2000-CAR.w*5,cruiseControl:-5});_this.addCar(i,{lane:1,x:2000+CAR.w*10,cruiseControl:-10});_this.addCar(i,{lane:1,x:2000-CAR.w*15,cruiseControl:-15});_this.addCar(i,{lane:1,x:2000+CAR.w*20,cruiseControl:-20})});this.resumeSim()}])},function(module,exports){angular.module("pageD3Almanac",["ngRoute"])},function(module,exports){angular.module("pageD3Almanac").config(["$routeProvider",function($routeProvider){$routeProvider.when("/d3/almanac/",{templateUrl:"pages/d3/almanac/almanac.html",controllerAs:"$ctrl",controller:function controller(){angular.element("[ng-view]").attr("ng-view","pageD3Almanac")}})}])}]);